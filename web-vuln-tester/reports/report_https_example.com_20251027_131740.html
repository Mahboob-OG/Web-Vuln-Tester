
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>WebVulnTester — Enhanced</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <style>
    body { padding:20px; background:#f5f7fb; }
    .card { box-shadow: 0 6px 18px rgba(40,50,80,0.06); }
    pre{ background:#0b0b0b;color:#eaeaea;padding:14px;border-radius:6px;overflow:auto; max-height:420px;}
    .header-badge{font-size:.9rem;padding:.35rem .6rem;border-radius:6px;}
    .missing{background:#ffefef;color:#b22;border:1px solid #f2c6c6;}
    .present{background:#eefdf3;color:#0b7;border:1px solid #cfe9d7;}
    /* print-friendly rules */
    @media print {
      body { background: white; color: #000; }
      nav, .btn, form, footer, .no-print { display: none !important; }
      .container { width: 100%; }
      pre { max-height: none; background: #f7f7f7; color: #000; }
      table { page-break-inside: avoid; }
    }
    /* dark theme */
    .dark body, .dark .card { background: #0b1020; color: #ddd; }
    .dark pre { background:#07101a; color:#cde8ff; }
  </style>
</head>
<body class="dark">
<div class="container">
  <div class="d-flex align-items-center mb-3">
    <h1 class="me-auto">WebVulnTester</h1>
    <div class="no-print text-muted">Local demo — do not expose publicly</div>
  </div>

  <div class="card p-3 mb-3 no-print">
    <form method="post" action="/scan" class="row g-2 align-items-center">
      <div class="col-md-5">
        <input name="target" type="text" class="form-control" placeholder="https://example.com" value="https://example.com" required />
      </div>
      <div class="col-md-2">
        <label class="form-check"><input class="form-check-input" type="checkbox" name="concurrent" value="1" /> Concurrent BF</label>
      </div>
      <div class="col-md-2">
        <input name="workers" type="number" min="1" max="80" class="form-control" placeholder="Workers" value="10" />
      </div>
      <div class="col-md-1">
        <label class="form-check"><input class="form-check-input" type="checkbox" name="dark" value="1" checked/> Dark</label>
      </div>
      <div class="col-md-2">
        <button class="btn btn-primary w-100" type="submit">Run scan</button>
      </div>
    </form>
  </div>

  
    <div class="row g-3 mb-3">
      <div class="col-md-3"><div class="card p-3"><div class="text-muted small">Target</div><div class="fw-bold">https://example.com</div></div></div>
      <div class="col-md-3"><div class="card p-3"><div class="text-muted small">Status</div><div class="fw-bold">200</div></div></div>
      <div class="col-md-3"><div class="card p-3"><div class="text-muted small">Vulns</div><div class="fw-bold text-success">0</div></div></div>
      <div class="col-md-3 d-flex align-items-stretch"><div class="card p-2 w-100"><div class="d-flex justify-content-between align-items-center"><div><small class="text-muted">Report</small><br/><strong>2025-10-27 13:17:40</strong></div><div><a class="btn btn-sm btn-outline-primary me-1" href="/reports/report_https_example.com_20251027_131740.html" target="_blank">Open</a><a class="btn btn-sm btn-primary" href="/reports/report_https_example.com_20251027_131740.html" download>Download</a>&nbsp;<button class="btn btn-sm btn-secondary" onclick="window.print()">Print</button></div></div></div></div>
    </div>

    <div class="card mb-3 p-3">
      <h5>Security headers</h5>
      <div class="row mt-2">
        
          <div class="col-md-4 mb-2">
            <div class="p-2 border rounded d-flex justify-content-between align-items-center">
              <div><div class="small text-muted">Content-Security-Policy</div><div class="fw-semibold">&lt;missing&gt;</div></div>
              <div><span class="header-badge missing">Missing</span></div>
            </div>
          </div>
        
          <div class="col-md-4 mb-2">
            <div class="p-2 border rounded d-flex justify-content-between align-items-center">
              <div><div class="small text-muted">X-Content-Type-Options</div><div class="fw-semibold">&lt;missing&gt;</div></div>
              <div><span class="header-badge missing">Missing</span></div>
            </div>
          </div>
        
          <div class="col-md-4 mb-2">
            <div class="p-2 border rounded d-flex justify-content-between align-items-center">
              <div><div class="small text-muted">X-Frame-Options</div><div class="fw-semibold">&lt;missing&gt;</div></div>
              <div><span class="header-badge missing">Missing</span></div>
            </div>
          </div>
        
          <div class="col-md-4 mb-2">
            <div class="p-2 border rounded d-flex justify-content-between align-items-center">
              <div><div class="small text-muted">X-XSS-Protection</div><div class="fw-semibold">&lt;missing&gt;</div></div>
              <div><span class="header-badge missing">Missing</span></div>
            </div>
          </div>
        
          <div class="col-md-4 mb-2">
            <div class="p-2 border rounded d-flex justify-content-between align-items-center">
              <div><div class="small text-muted">Strict-Transport-Security</div><div class="fw-semibold">&lt;missing&gt;</div></div>
              <div><span class="header-badge missing">Missing</span></div>
            </div>
          </div>
        
          <div class="col-md-4 mb-2">
            <div class="p-2 border rounded d-flex justify-content-between align-items-center">
              <div><div class="small text-muted">Referrer-Policy</div><div class="fw-semibold">&lt;missing&gt;</div></div>
              <div><span class="header-badge missing">Missing</span></div>
            </div>
          </div>
        
      </div>
    </div>

    <div class="row">
      <div class="col-lg-7">
        <div class="card mb-3 p-3">
          <h5>Forms (0)</h5>
          <p>No forms found.</p>
        </div>

        <div class="card mb-3 p-3">
          <h5>Directory brute-force (1)</h5>
          
            <table class="table table-sm"><thead><tr><th>URL</th><th>Status</th></tr></thead><tbody><tr><td><a href="https://example.com/index.html" target="_blank">https://example.com/index.html</a></td><td>200</td></tr></tbody></table>
          
        </div>
      </div>

      <div class="col-lg-5">
        <div class="card mb-3 p-3">
          <h5>Vulnerabilities (0)</h5>
          <p>No automated vulnerabilities detected.</p>
        </div>

        <div class="card mb-3 p-3">
          <h5>Cookies & issues</h5>
          
            <p>No cookies set or detected.</p>
          
        </div>

        <div class="card mb-3 p-3">
          <h5>robots.txt</h5>
          <p>Not found or no response.</p>
        </div>
      </div>
    </div>

    <div class="card p-3 mt-3">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0">Raw JSON output</h5>
        <div class="no-print"><button class="btn btn-sm btn-outline-secondary" id="copyBtn">Copy JSON</button></div>
      </div>
      <pre id="rawPre">{
  &#34;target&#34;: &#34;https://example.com&#34;,
  &#34;final_url&#34;: &#34;https://example.com/&#34;,
  &#34;status_code&#34;: 200,
  &#34;content_type&#34;: &#34;text/html&#34;,
  &#34;security_headers&#34;: {
    &#34;Content-Security-Policy&#34;: null,
    &#34;X-Content-Type-Options&#34;: null,
    &#34;X-Frame-Options&#34;: null,
    &#34;X-XSS-Protection&#34;: null,
    &#34;Strict-Transport-Security&#34;: null,
    &#34;Referrer-Policy&#34;: null
  },
  &#34;robots_txt&#34;: null,
  &#34;forms&#34;: [],
  &#34;vulnerabilities&#34;: [],
  &#34;bruteforce&#34;: [
    {
      &#34;url&#34;: &#34;https://example.com/index.html&#34;,
      &#34;status&#34;: 200
    }
  ],
  &#34;cookies&#34;: [],
  &#34;cookie_issues&#34;: []
}


--- Concurrent bruteforce output (merged) ---
[
  {
    &#34;url&#34;: &#34;https://example.com/index.html&#34;,
    &#34;status&#34;: 200
  }
]</pre>
    </div>
  

  <footer class="text-center text-muted mt-4 small no-print">WebVulnTester — educational demo. Only scan with permission.</footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script>
document.getElementById('copyBtn')?.addEventListener('click', async function(){
  const txt = document.getElementById('rawPre').innerText;
  try {
    await navigator.clipboard.writeText(txt);
    alert('JSON copied to clipboard');
  } catch(e) {
    alert('Copy failed — select and copy manually.');
  }
});
</script>
</body>
</html>